### Raft
- 分布式系统设计中的CAP理论： 没有一种设计能同时满足 一致性，可用性，分区容错性
    - 一致性：在分布式系统中，对于同一时间不同客户端的读操作，要么返回一致的最新数据，要么返回一个错误
    - 可用性：服务在接受到客户端的请求后，都能够给出响应；不会返回错误，但不能保证数据一定是最新的
    - 分区容错性：不同节点之间通过网络进行通信，基于网络的不可靠性，位于不同网络分区的节点可能会通信失败，系统需要容忍这种情况(服务不会宕机)

- 提升Raft的读写性能
    - 虽然 Raft 提供了强一致性，但由于一致性带来的通信开销和日志复制的同步操作，其性能往往相对较低。为了提升 Raft 的读写性能，可以从以下几个方面进行优化：

    1. 提高并发性
    读写分离：Raft 的 Leader 处理所有的读写请求，这可能会成为瓶颈。通过将读操作从写操作中分离，允许 Follower 节点处理只读请求，可以显著提高系统的读性能。
    Leader Lease：Leader 可以利用“租约机制”，即通过定期发送心跳消息，保证自己是 Leader 的状态，让 Follower 节点安全地提供读服务。
    只读 Leader Cache：让 Leader 维护一个最新的状态缓存，直接返回客户端的读请求，而无需遍历整个日志。
    2. 批量日志复制
    批处理日志条目：Raft 每次会将客户端的写请求作为日志条目，复制到集群中的其他节点。如果每次写请求只复制一个日志条目，会造成大量网络开销。通过将多个日志条目批量复制，能够减少通信次数，从而提升写入性能。
    3. 异步日志同步
    异步复制：Raft 默认会等待多数节点成功复制日志条目后才确认提交。如果允许异步复制（即不需要等待所有节点的应答），Leader 在复制日志后立即向客户端返回确认，这会显著提高系统的写性能。不过，这样的优化会影响系统的容错性，因此需要谨慎使用。
    4. 快照机制（Snapshotting）
    定期生成快照：Raft 会记录所有的操作日志，但随着时间推移，日志条目数量会逐渐增加，影响系统性能。为了避免这种情况，可以定期生成状态快照，将整个状态机的当前状态保存为快照，并丢弃旧的日志记录。这种方式可以减少节点恢复和重启时的日志重放时间，提升系统的整体性能。
    5. 日志压缩（Log Compaction）
    压缩日志：随着日志条目的增长，性能会因为日志量过大而下降。Raft 可以通过日志压缩策略，删除或合并一些旧的、已经提交的日志条目，只保留必要的日志，从而降低存储开销和处理延迟。
    6. 利用硬件加速
    使用 SSD、NVM（Non-Volatile Memory）：I/O 性能对 Raft 性能至关重要，特别是写入日志时的同步操作。如果使用速度更快的硬盘（如 SSD）或非易失性存储（NVM），可以显著减少 Raft 在日志持久化过程中的延迟，提升整体性能。
    7. 调优超时时间和心跳间隔
    优化超时参数：Raft 通过心跳和选举超时来检测节点故障和选举新 Leader。合理地调节这些超时参数（如选举超时时间、心跳间隔），可以在提高系统响应速度和稳定性之间取得平衡，从而提升系统的性能。
    8. 多 Raft Group
    分区/分片（Sharding）：对于大型系统，可以将数据分成多个子集，每个子集维护一个独立的 Raft Group。这种分区方式能够通过水平扩展提升系统的吞吐量，避免单个 Raft 集群成为瓶颈。


